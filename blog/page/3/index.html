
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>alanthing</title>
  <meta name="author" content="Alan Ivey">

  
  <meta name="description" content="This post originally featured on the Echo &amp; Co. blog. UPDATE: See Three Ways to Get Drush on OS X for a newer guide. At EchoDitto, we&rsquo;re &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://alanthing.com/blog/page/3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="alanthing" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34327970-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">alanthing</a></h1>
  
    <h2>Linux and other things</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:alanthing.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/25/keep-drush-date/">Keep Drush Up to Date</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-25T17:39:00-04:00" pubdate data-updated="true">Mar 25<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/2011/03/keep-drush-up-to-date">Echo &amp; Co. blog</a></em>.</p>

<p><strong>UPDATE:</strong> See <a href="/blog/2012/08/29/three-ways-get-drush-os-x/">Three Ways to Get Drush on OS X</a> for a newer guide.</p>

<p>At <a href="http://www.echoditto.com">EchoDitto</a>, we&rsquo;re big fans of <a href="http://drupal.org/project/drush">Drush</a>. It&rsquo;s installed on all of our servers and it&rsquo;s a great way to <a href="http://drush.ws/#core-cron">perform maintenance tasks</a>, <a href="http://drush.ws/#pm-download">download core and modules</a>, and <a href="http://www.lullabot.com/articles/drush-make-and-pressflow">much much more</a>. I&rsquo;m not a big fan of installing from zip files though, so let&rsquo;s use git to easily keep our Drush install up to date.</p>

<p>Before <a href="http://www.lullabot.com/blog/git-coming-soon-drupalorg">the git transition</a>, I would use Subversion to check out the latest drush release somewhere, like /usr/local/drush (on my Mac), using the CVS clone <a href="http://dembach.net/subversible/en">Subversible</a>. Today, however, I noticed that the latest tagged release Subversible has is <a href="https://subversible.svn.beanstalkapp.com/modules/drush/tags/">4.2</a>, and the <a href="http://drupal.org/project/drush">Drush project page</a> has 4.4 ready to download. I figured now would be a good time to start using <a href="http://git-scm.com/">git</a> for this and stop relying on a third-party to provide the code for Subversion.</p>

<p>The commands below will walk through cloning the Drush git repository and then switching to the latest release. I realize the <a href="http://drush.ws/#self-update">drush self-update</a> will soon make this irrelevant, but this method works today and is a great exercise in learning how Drupal is using git, especially important coming from Subversion.</p>

<p>Clone the repository. It will create the subfolder &ldquo;drush&rdquo; from your current working directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git clone --branch master http://git.drupal.org/project/drush.git
</span><span class='line'><span class="nb">cd </span>drush
</span></code></pre></td></tr></table></div></figure>


<p>Use pear to download <em>includes/table.inc</em>. This one-liner will take care of everything for you as long as you have pear installed and are in the new drush directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>pear download Console_Table
</span><span class='line'>tar zxvf <span class="sb">`</span>ls Console_Table-*.tgz<span class="sb">`</span> <span class="sb">`</span>ls Console_Table-*.tgz | sed -e <span class="s1">&#39;s/\.[a-z]\{3\}$//&#39;</span><span class="sb">`</span>/Table.php
</span><span class='line'>mv <span class="sb">`</span>ls Console_Table-*.tgz | sed -e <span class="s1">&#39;s/\.[a-z]\{3\}$//&#39;</span><span class="sb">`</span>/Table.php includes/table.inc
</span><span class='line'>chmod 0644 includes/table.inc <span class="o">&amp;&amp;</span> rm -fr Console_Table-*
</span></code></pre></td></tr></table></div></figure>


<p>At this point you may or may not have a functioning Drush installation, because you&rsquo;re using the HEAD of the Drush code repository and it might contain broken code. I would recommend switching the checkout to the latest release. We&rsquo;ll start by viewing all releases:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git tag
</span><span class='line'>5.x-1.0
</span><span class='line'>5.x-1.0-beta1
</span><span class='line'>5.x-1.0-beta2
</span><span class='line'>... snip ...
</span><span class='line'>7.x-4.2
</span><span class='line'>7.x-4.3
</span><span class='line'>7.x-4.4
</span><span class='line'>debian/4.3-1
</span><span class='line'>debian/4.4-1
</span></code></pre></td></tr></table></div></figure>


<p>As of this writing, there are over 50 results from this command, but you&rsquo;ll see the latest is &ldquo;7.x-4.4&rdquo;. If we want our local Drush install to be at 4.4, change the checkout:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git checkout 7.x-4.4
</span><span class='line'>Previous HEAD position was 1532d0c... <span class="c">#1079434 by msonnabaum. Add .gitignore for includes/table.inc</span>
</span><span class='line'>HEAD is now at a808ff0... Updating drush version
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s it! Drush is set up on 4.4:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>drush --version
</span><span class='line'>drush version 4.4
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s say 4.5 is released tomorrow and you want to change your checkout. First you&rsquo;ll need to update the local git repository: <code>git pull</code></p>

<p>View the list of tags:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>git tag
</span><span class='line'>5.x-1.0
</span><span class='line'>5.x-1.0-beta1
</span><span class='line'>5.x-1.0-beta2
</span><span class='line'>... snip ...
</span><span class='line'>7.x-4.3
</span><span class='line'>7.x-4.4
</span><span class='line'>7.x-4.5
</span><span class='line'>debian/4.3-1
</span><span class='line'>debian/4.4-1
</span><span class='line'>debian/4.5-1
</span></code></pre></td></tr></table></div></figure>


<p>And switch your checkout to the new release: <code>git checkout 7.x-4.5</code></p>

<p>Repeat for future releases, and enjoy! Of course, once <a href="http://drush.ws/#self-update">drush self-update</a> begins working, that will be the preferred method, but this will work today. Please questions or comments below.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/22/dump-each-mysql-table-file/">Dump Each MySQL Table to a File</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-22T14:30:00-05:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/dump-each-mysql-table-file">Echo &amp; Co. blog</a></em>.</p>

<p>Here&rsquo;s a one-liner to dump each table in a database to it&rsquo;s own .sql file. Crack open your shell of choice and follow along.</p>

<p>Replace the USER, PASSWORD, and DBNAME values with your own. If you&rsquo;re not running this to connect to a local database, add &mdash;host=domain.tld after each password to connect to your remote server.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for i in $(mysql -uUSER -p'PASSWORD' --batch --skip-column-names DBNAME -e'show tables;'); do mysqldump -uUSER -p'PASSWORD' DBNAME $i &gt; DBNAME-$i.sql; done</span></code></pre></td></tr></table></div></figure>


<p>Users, passwords, and database names are case sensitive, I made them uppercase here to call them out. Leave a comment if you have a question or notice a problem or typo.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/02/15/fix-pear-permissions-problem-mac-os-x/">Fix Pear Permissions Problem on Mac OS X</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-15T16:34:00-05:00" pubdate data-updated="true">Feb 15<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/fix-pear-permissions-problem-mac-os-x">Echo &amp; Co. blog</a></em>.</p>

<p>On Snow Leopard, you can install drush without using sudo. A dependency for installing drush is downloading a Pear library. The following example should allow you to be able to use the following commands to install drush to /usr/local/drush with a symlink in /usr/local/bin/drush, but it fails on the &lsquo;pear download&rsquo; step, even though it&rsquo;s writing to a user-writeable directory. Read on the figure out how to fix this annoying problem.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>svn co http://subversible.svn.beanstalkapp.com/modules/drush/tags/DRUPAL-7--4-2/ /usr/local/drush 
</span><span class='line'>cd /tmp 
</span><span class='line'>pear download Console_Table 
</span><span class='line'>tar zxvf `ls Console_Table-*.tgz` `ls Console_Table-*.tgz | sed -e 's/\.[a-z]\{3\}$//'`/Table.php 
</span><span class='line'>mv `ls Console_Table-*.tgz | sed -e 's/\.[a-z]\{3\}$//'`/Table.php 
</span><span class='line'>/usr/local/drush/includes/table.inc $ rm -fr Console_Table-* 
</span><span class='line'>ln -s /usr/local/drush/drush /usr/local/bin/drush</span></code></pre></td></tr></table></div></figure>


<p>This assumes 1) /usr/local exists and you can write to it, and 2) you&rsquo;ve added the following to your ~/.profile (or ~/.bashrc or ~/.bash_profile):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Use the built-in PEAR and PECL scripts
</span><span class='line'>alias pear="/usr/bin/php /usr/lib/php/pearcmd.php"
</span><span class='line'>alias pecl="/usr/bin/php /usr/lib/php/peclcmd.php"</span></code></pre></td></tr></table></div></figure>


<p>But, OS X has a strange permissions problem when using pear for the first time. Running &lsquo;pear download&rsquo; should not require sudo, but if you&rsquo;ve never used pear before you&rsquo;ll get this error:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pear download Console_Table 
</span><span class='line'>
</span><span class='line'>Warning: touch(): Unable to create file /usr/lib/php/.lock because Permission denied in PEAR/Registry.php on line 835 
</span><span class='line'>
</span><span class='line'>Warning: touch(): Unable to create file /usr/lib/php/.lock because Permission denied in /usr/lib/php/PEAR/Registry.php on line 835 
</span><span class='line'>could not create lock file: fopen(/usr/lib/php/.lock): failed to open stream: No such file or directory 
</span><span class='line'>invalid package name/package file "Console_Table" 
</span><span class='line'>download failed</span></code></pre></td></tr></table></div></figure>


<p>Strange, right? Administrators in OS X are in the wheel group, but /usr/lib/php is not writable by the group. Before you go changing permissions (which might not be retained after an OS X update), all you have to do is run something as root with pear:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pear list
</span><span class='line'>Installed packages, channel pear.php.net:
</span><span class='line'>=========================================
</span><span class='line'>Package          Version State
</span><span class='line'>Archive_Tar      1.3.3   stable
</span><span class='line'>Console_Getopt   1.2.3   stable
</span><span class='line'>PEAR             1.8.0   stable
</span><span class='line'>Structures_Graph 1.0.2   stable
</span><span class='line'>XML_Util         1.2.1   stable</span></code></pre></td></tr></table></div></figure>


<p>The permissions and ownership of /usr/lib/php are still the same, but there is now the file /usr/lib/php/.lock</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -Al /usr/lib/php/.lock
</span><span class='line'>-rw-r--r--  1 root  wheel  0 Feb 15 16:08 /usr/lib/php/.lock</span></code></pre></td></tr></table></div></figure>


<p>You&rsquo;d think that when pear has completed running the list command it would delete the .lock file, but it doesn&rsquo;t. But since it&rsquo;s there, the original pear download command will now run without sudo:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pear download Console_Table
</span><span class='line'>downloading Console_Table-1.1.4.tgz ...
</span><span class='line'>Starting to download Console_Table-1.1.4.tgz (9,369 bytes)
</span><span class='line'>.....done: 9,369 bytes
</span><span class='line'>File /private/tmp/Console_Table-1.1.4.tgz downloaded</span></code></pre></td></tr></table></div></figure>


<p>Of course, running &lsquo;pear install&rsquo; or many other commands will require sudo, but it&rsquo;s silly that commands that do not write any files to /usr/lib/php or its children would require sudo.</p>

<p>Unrelated to the pear permissions issue, but related to my drush install script; this assumes that /usr/local and /usr/local/bin exist. By default, /usr/local/bin is in the $PATH regardless of whether or not the folder exists, but on a vanilla OS X install /usr/local does not exist. I have both Xcode and homebrew installed. I know homebrew will create /usr/local for you, but I&rsquo;m not sure about Xcode. If you don&rsquo;t want to have either installed but want drush installed to /usr/local, run this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo mkdir -p /usr/local/bin
</span><span class='line'>sudo chown -R root:wheel /usr/local</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/01/25/easy-php-5-dot-2-rpms-on-centos/">Easy PHP 5.2 RPMs on CentOS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-25T10:13:00-05:00" pubdate data-updated="true">Jan 25<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/easy-php-52-rpms-centos">Echo &amp; Co. blog</a></em>.</p>

<p>I had previously <a href="http://echodittolabs.org/blog/2009/05/all-i-want-php-52-centosrhel">written a post</a> on one method of upgrading PHP from 5.1 to 5.2 on CentOS and Red Hat servers by creating new RPMs. Since then, I have found a much better way to create PHP 5.2.17 (or newer) RPMs to easily upgrade (and later remove, if you want) the older version available by default. I&rsquo;ll presume you have no prior experience building PHP RPMs.</p>

<p>We start by adding the <a href="http://fedoraproject.org/wiki/EPEL">Extra Packages for Enterprise Linux (EPEL) repository</a> to our server. EPEL is safe to add as an additional repository and leave enabled because it <a href="http://fedoraproject.org/wiki/EPEL/FAQ#How_is_EPEL_different_from_other_third_party_repositories_for_RHEL_and_derivatives.3F">provides complementary packages only</a> and will not conflict with the CentOS or Red Hat repositories. Since their installation method may change, I won&rsquo;t reproduce it here; instead head over to the <a href="http://fedoraproject.org/wiki/EPEL/FAQ#howtouse">installation portion of the FAQ</a> and it&rsquo;s just one line to get started with EPEL.</p>

<p>With EPEL enabled, we will need just one new package to build RPMs: <a href="http://fedoraproject.org/wiki/Projects/Mock">Mock</a>. Mock will create a chroot, download what&rsquo;s necessary to build your RPM, build, and cleanup afterwards. Mock only requires a couple of python packages as dependencies; it will not require a compiler or anything like that since mock will grab them as needed during operation. I will presume you are not running as root so I will use sudo as necessary. To install mock:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install mock
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s it. You can run all mock operations with the &lsquo;sudo&rsquo; command to run as root, but your packages will be built inside the chroot as a non-root user. Or, if you prefer to not use sudo when running mock, add your user to the mock group (where username is your user):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo /usr/sbin/usermod -G mock username
</span></code></pre></td></tr></table></div></figure>


<p>Using the source code from php.net and creating a RPM spec file from scratch would be a lot of work, so we&rsquo;ll grab a source RPM for PHP 5.2. I&rsquo;ve found that <a href="http://blog.famillecollet.com/">Remi</a> has the most up-to-date RPM spec with the latest patches and robust install scripts. <a href="http://rpms.famillecollet.com/SRPMS/">Browse Remi&rsquo;s SRPMS</a> and download the latest PHP 5.2 file. As of this writing, it&rsquo;s php-5.2.17-1.remi.src.rpm. On your system, download it with wget in your home directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> ~
</span><span class='line'>wget http://rpms.famillecollet.com/SRPMS/php-5.2.17-1.remi.src.rpm
</span></code></pre></td></tr></table></div></figure>


<p>Now, we could just run mock and rebuild this source RPM and hopefully install the results, but it would fail due to not having sqlite2-devel installed. Remi provides sqlite2 and sqlite2-devel, so you could add Remi&rsquo;s yum repository to your mock settings, but then it would grab Remi&rsquo;s other updated packages like MySQL 5.5 and others during the PHP build. My goal here is to only build PHP against Base CentOS and EPEL packages. So, we have to edit the spec file and rebuild the source RPM before passing it off to mock. Don&rsquo;t worry; while there are a few steps, it&rsquo;s not very difficult if you follow closely.</p>

<p>To unpack the source RPM we just downloaded into our home directory, we&rsquo;ll need to set up the .rpmmacros file in our home directory. Why? Without it, it will attempt to extract to /usr/src/redhat, and only root can use that directory, and you should <a href="http://wiki.centos.org/HowTos/SetupRpmBuildEnvironment">never build any packages as a privileged user</a>. We&rsquo;ll create the macros file and the directories it needs from your home directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> ~
</span><span class='line'><span class="nb">echo</span> <span class="s1">&#39;%_topdir %(echo $HOME)/rpmbuild&#39;</span> &gt; ~/.rpmmacros
</span><span class='line'>mkdir -p ~/rpmbuild/<span class="o">{</span>SOURCES,SPECS,SRPMS<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Unpack the source RPM. This will extract the PHP 5.2.17 source and any patches and configuration files into ~/rpmbuild/SOURCES, and the spec file will be in ~/rpmbuild/SPECS:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rpm -ivh php-5.2.17-1.remi.src.rpm
</span></code></pre></td></tr></table></div></figure>


<p>Now we need to make a couple of changes to the spec file. We&rsquo;ll change to the SPECS directory and make a copy of Remi&rsquo;s spec file so we can keep it for reference:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> ~/rpmbuild/SPECS
</span><span class='line'>cp -a php52.spec php.spec
</span></code></pre></td></tr></table></div></figure>


<p>Open up php.spec in your favorite text editor and let&rsquo;s have the PHP configure script use the bundled SQLite2 libraries instead of searching for ones on your system:</p>

<ol>
<li>Find the line &ldquo;BuildRequires: sqlite2-devel >= 2.8.0&rdquo; and delete it</li>
<li>Find &ldquo;&mdash;with-sqlite=shared,%{_prefix} \&rdquo; and replace it with &ldquo;&mdash;with-sqlite=shared \&rdquo;</li>
<li>Optionally: Add your own lines to the %changelog describing that you removed the sqlite2-devel build requirement</li>
<li>Optionally: Remove the first 4 lines after &ldquo;%pre common&rdquo; to remove Remi&rsquo;s note about their forums</li>
</ol>


<p>It took 2 small tweaks to remove the sqlite2-devel RPM requirement not found in our standard repositories. See <a href="http://paste.ly/4Yrx">php.spec.diff</a> to see only the changes we made; or <a href="http://paste.ly/4Ys5">php.spec</a> for the complete file if you do not want to edit it yourself.</p>

<p>The hard part is now over! It&rsquo;s easy from here on out. First step is to build the newly-edited spec into your own source RPM. But first, if you don&rsquo;t have &ldquo;rpmbuild&rdquo; available, it&rsquo;s a quick install via yum:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install rpm-build
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s possible your system may have already had the yum package rpm-build installed. We&rsquo;ll build our source RPM with &ldquo;-bs&rdquo; to <strong>b</strong>uild the <strong>s</strong>ource, and &ldquo;&mdash;nodeps&rdquo; to prevent our system from checking all of the &ldquo;Requires&rdquo; in the spec since we&rsquo;re just building the source:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rpmbuild --nodeps -bs php.spec
</span><span class='line'>Wrote: /home/username/rpmbuild/SRPMS/php-5.2.17-1.src.rpm
</span></code></pre></td></tr></table></div></figure>


<p>rpmbuild will show you where it wrote your source RPM. All we have to do is provide it to mock; &ldquo;-v&rdquo; will give us verbose output and &ldquo;-r epel-5-x86_64&rdquo; will use the mock profile at &ldquo;/etc/mock/epel-5-x86_64.cfg&rdquo;. If you&rsquo;re on a 32-bit system, change &ldquo;epel-5-x86_64&rdquo; to &ldquo;epel-5-i386&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> ~/rpmbuild/SRPMS
</span><span class='line'>mock -v -r epel-5-x86_64 php-5.2.17-1.src.rpm
</span></code></pre></td></tr></table></div></figure>


<p>The output shows you that mock is creating a chroot, downloading the bare essentials needed for a chroot and compiling tools, ccache to speed up compilation, and the packages in all &ldquo;Requires&rdquo; lines in the spec file. When mock is finished with the build after several minutes, you&rsquo;ll see output similar to:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>INFO: Done<span class="o">(</span>php-5.2.17-1.src.rpm<span class="o">)</span> Config<span class="o">(</span>epel-5-x86_64<span class="o">)</span> 10 minutes 20 seconds
</span><span class='line'>INFO: Results and/or logs in: /var/lib/mock/epel-5-x86_64/result
</span></code></pre></td></tr></table></div></figure>


<p>The /var/lib/mock/epel-5-x86_64/results/ folder will contain all of your PHP RPMs, including another source RPM. You can now either install these PHP packages by hand, or you can dump them into <a href="http://www.techrepublic.com/blog/opensource/create-your-own-yum-repository/609">your own Yum repository</a> and install with yum.</p>

<h3>TL;DR</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install mock
</span><span class='line'>sudo /usr/sbin/usermod -G mock username
</span><span class='line'><span class="nb">cd</span> ~
</span><span class='line'>wget http://rpms.famillecollet.com/SRPMS/php-5.2.17-1.remi.src.rpm
</span><span class='line'><span class="nb">echo</span> <span class="s1">&#39;%_topdir %(echo $HOME)/rpmbuild&#39;</span> &gt; ~/.rpmmacros
</span><span class='line'>mkdir -p ~/rpmbuild/<span class="o">{</span>SOURCES,SPECS,SRPMS<span class="o">}</span>
</span><span class='line'>rpm -ivh php-5.2.17-1.remi.src.rpm
</span><span class='line'><span class="nb">cd</span> ~/rpmbuild/SPECS
</span><span class='line'>cp -a php52.spec php.spec
</span><span class='line'>sed -i <span class="s2">&quot;/BuildRequires\: sqlite2-devel/d&quot;</span> php.spec
</span><span class='line'>sed -i <span class="s2">&quot;s/--with-sqlite=shared,%{_prefix}/--with-sqlite=shared/&quot;</span> php.spec
</span><span class='line'>sudo yum install rpm-build
</span><span class='line'>rpmbuild --nodeps -bs php.spec
</span><span class='line'><span class="nb">cd</span> ~/rpmbuild/SRPMS
</span><span class='line'>mock -v -r epel-5-x86_64 php-5.2.17-1.src.rpm
</span></code></pre></td></tr></table></div></figure>


<p>Resulting RPMs will be in /var/lib/epel-5-x86_64/results. If on a 32-bit system, replace epel-5-x86_64 with epel-5-i386.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/01/05/are-your-wordpress-sites-running-the-latest-core/">Are Your WordPress Sites Running the Latest Core?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-05T20:31:00-05:00" pubdate data-updated="true">Jan 5<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/are-your-wordpress-sites-running-latest-core">Echo &amp; Co. blog</a></em>.</p>

<p>In addition to hosting Drupal sites, we also host a number of WordPress sites. Similar to (checking all of our Drupal core versions)[<a href="http://echodittolabs.org/blog/2011/01/are-your-drupal-sites-running-latest-core">http://echodittolabs.org/blog/2011/01/are-your-drupal-sites-running-latest-core</a>], we needed an easy way to quickly see what versions we are running on all of our WordPress sites. Kudos to <a href="http://echodittolabs.org/users/ethan">Ethan</a> for getting this one kicked off; here is a bash script to check your definable <code>$WEBHOME</code> (where you deposit all of your WordPress webroots) and scan for WordPress versions.</p>

<p>Note: this requires bash, grep, wc, sed, awk, and tree. If your system doesn&rsquo;t have tree, it&rsquo;s usually pretty easy to get from EPEL/Homebrew/apt-get/[mac]ports/etc.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Where to start scanning</span>
</span><span class='line'><span class="nv">WEBHOME</span><span class="o">=</span>/var/www/vhosts
</span><span class='line'>
</span><span class='line'><span class="c"># Workaround to fix awk counting below</span>
</span><span class='line'><span class="nv">WEBHOMECOUNT</span><span class="o">=</span><span class="k">$(($(</span><span class="nb">echo</span> <span class="s2">&quot;${WEBHOME}&quot;</span>|grep -o <span class="s2">&quot;/&quot;</span>|wc -l| sed s/<span class="se">\ </span>//g<span class="k">)</span><span class="o">+</span><span class="m">2</span><span class="k">))</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Other projects could use &#39;version.php&#39; so we include </span>
</span><span class='line'><span class="c"># &#39;wp-includes/&#39; in our search to limit it to WordPress</span>
</span><span class='line'><span class="k">for </span>i in <span class="k">$(</span>tree -L 5 -if <span class="k">${</span><span class="nv">WEBHOME</span><span class="k">}</span> | grep <span class="s1">&#39;wp-includes/version.php&#39;</span><span class="k">)</span>; <span class="k">do</span>
</span><span class='line'><span class="k">  </span><span class="nv">SITE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span>|awk -v <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;$WEBHOMECOUNT&quot;</span> -F/ <span class="s1">&#39;{for(j=count;j&lt;=NF-2;j++) \</span>
</span><span class='line'><span class="s1">        printf $j&quot;/&quot;}&#39;</span> | sed <span class="s1">&#39;s/.$//g&#39;</span><span class="k">)</span>
</span><span class='line'>  <span class="nv">VERSION</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&quot;wp_version = &quot;</span> <span class="nv">$i</span>|awk -F<span class="se">\&#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="nv">$SITE</span> - <span class="nv">$VERSION</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p>As a result, you&rsquo;ll see output like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>./wordpress-version-check.sh
</span><span class='line'>speedyupdates.com - 3.0.4
</span><span class='line'>littlebehind.org - 3.0.3
</span><span class='line'>scaredtoupgrade.com/blog - 2.8.2
</span><span class='line'>kickinitoldschool.org/web/wordpress - 2.0.2
</span></code></pre></td></tr></table></div></figure>


<p>If you think there&rsquo;s a better way, or have any questions, let me know in the comments.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/01/05/are-your-drupal-sites-running-the-latest-core/">Are Your Drupal Sites Running the Latest Core?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-05T19:25:00-05:00" pubdate data-updated="true">Jan 5<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/are-your-drupal-sites-running-latest-core">Echo &amp; Co. blog</a></em>.</p>

<p>At <a href="http://www.echoditto.com">EchoDitto</a>, we host a lot of Drupal sites. Just about all of our web servers contain more than one completely separate Drupal cores since we develop most of our websites independently. We also keep an eye out on <a href="http://drupal.org/security">Drupal Security</a> and when to apply core updates. Since we&rsquo;re not using Aegir, nor do we run every site off of a single multi-site core install, we need a quick and easy way to see what versions we&rsquo;re running.</p>

<p>Here&rsquo;s a shell script we recently developed to report the Drupal Core versions for all of our sites under a single parent folder. It works on Drupal 4 through 7. It&rsquo;s not been tested outside of our platform, or non-RHEL systems, but it should be universal as long as you have bash, find, awk, and grep. I decided not to use <a href="http://drupal.org/project/drush">Drush</a> because it would involve bootstrapping every site and invoking PHP; this is just more lightweight. Drush also would not work for Drupal 4 sites, which we surprisingly still have a couple kicking around still.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Where to start looking</span>
</span><span class='line'><span class="nv">WEBHOME</span><span class="o">=</span>/var/www/vhosts
</span><span class='line'>
</span><span class='line'><span class="c"># Workaround to fix awk counting below, but it works</span>
</span><span class='line'><span class="nv">WEBHOMECOUNT</span><span class="o">=</span><span class="k">$(($(</span><span class="nb">echo</span> <span class="s2">&quot;${WEBHOME}&quot;</span>|grep -o <span class="s2">&quot;/&quot;</span>|wc -l| sed s/<span class="se">\ </span>//g<span class="k">)</span><span class="o">+</span><span class="m">2</span><span class="k">))</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Change maxdepth from 5 to some other value if your webroot is not being detected</span>
</span><span class='line'><span class="k">for </span>i in <span class="k">$(</span>find <span class="nv">$WEBHOME</span> -maxdepth 5 -type f -name system.module<span class="k">)</span>; <span class="k">do</span>
</span><span class='line'>  <span class="c"># Grabs only the version number from the file as described </span>
</span><span class='line'>  <span class="c"># at http://drupal.org/handbook/version-info</span>
</span><span class='line'>  <span class="nv">VERSION</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&quot;VERSION&quot;</span> <span class="k">${</span><span class="nv">i</span><span class="k">}</span>|awk -F<span class="se">\&#39;</span> <span class="s1">&#39;{print $4}&#39;</span><span class="k">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Drupal 4 has the system.module file in a lower directory than 5+</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$VERSION</span> <span class="o">==</span> 4* <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">    </span><span class="nv">SITE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span>|awk -v <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;$WEBHOMECOUNT&quot;</span> -F/ <span class="s1">&#39;{for(j=count;j&lt;=NF-2;j++) \</span>
</span><span class='line'><span class="s1">           printf $j&quot;/&quot;}&#39;</span> | sed <span class="s1">&#39;s/.$//g&#39;</span><span class="k">)</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'><span class="k">    </span><span class="nv">SITE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span>|awk -v <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;$WEBHOMECOUNT&quot;</span> -F/ <span class="s1">&#39;{for(j=count;j&lt;=NF-3;j++) \</span>
</span><span class='line'><span class="s1">           printf $j&quot;/&quot;}&#39;</span> | sed <span class="s1">&#39;s/.$//g&#39;</span><span class="k">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">[</span> -z <span class="nv">$VERSION</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'>      <span class="c"># Drupal 7 does not keep the version number on system.module, despite the </span>
</span><span class='line'>      <span class="c"># drupal.org page. Grab from changelog (disabled b/c it includes extra info)</span>
</span><span class='line'>      <span class="c">#VERSION=&quot;$(sed &#39;3q;d&#39; ${WEBHOME}/${SITE}/CHANGELOG.txt)&quot;</span>
</span><span class='line'>      <span class="c"># All versions of Drupal have the version of the module in system.info, </span>
</span><span class='line'>      <span class="c"># so we grab it here for D7. The only reason I&#39;m not using this for all </span>
</span><span class='line'>      <span class="c"># versions is because of the aforementioned drupal.org page</span>
</span><span class='line'>      <span class="nv">VERSION</span><span class="o">=</span><span class="k">$(</span>grep <span class="s2">&quot;version = \&quot;&quot;</span> <span class="k">${</span><span class="nv">WEBHOME</span><span class="k">}</span>/<span class="k">${</span><span class="nv">SITE</span><span class="k">}</span>/modules/system/system.info <span class="se">\</span>
</span><span class='line'>                | awk -F<span class="se">\&quot;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
</span><span class='line'>    <span class="k">fi</span>
</span><span class='line'><span class="k">  fi</span>
</span><span class='line'><span class="k">  </span><span class="nb">echo</span> <span class="nv">$SITE</span> - <span class="nv">$VERSION</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p>As a result, you&rsquo;ll see the directory tree after <code>$WEBHOME</code> where the root of the site is and the version number. Below is an example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>./drupal-version-check.sh
</span><span class='line'>mysite.org/www - 5.22
</span><span class='line'>thissite.net - 4.7.11
</span><span class='line'>subfolder/drupalftw.com - 6.12
</span><span class='line'>blah.org/trunk - 7.0
</span></code></pre></td></tr></table></div></figure>


<p>If you have suggestions, please send them over. This script is still young and I&rsquo;d love to see if anyone has any better ideas.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/12/07/combined-apache-logs-for-load-balanced-web-servers/">Combined Apache Logs for Load Balanced Web Servers</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-07T14:34:00-05:00" pubdate data-updated="true">Dec 7<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When dealing with a load spike or unexplained poor performance, once of the first things to do is to check the Apache web server logs. However, when dealing with multiple web servers behind a load balancer, it can be cumbersome to check through multiple logs on different machines.</p>

<p>Luckily, if you have shared storage, itâ€™s pretty simple to write to a single log file. Apache allows for log file locations to go to a pipe, which means you can redirect the output anywhere else. This was initially done to allow Apache to release open file descriptors since it can begin to create problems with more than 300 domains. But you donâ€™t need to have 300 websites to see the benefits of using a pipe for logging.</p>

<p>In your VirtualHost declaration, change your logging options from:</p>

<pre><code>CustomLog logs/domain.com-access_log combined
</code></pre>

<p>to:</p>

<pre><code>CustomLog "|/bin/cat Â» /var/www/vhosts/_logs/domain.com-access_log" combined
</code></pre>

<p>In this example, /var/www/vhosts is the shared SAN storage device, and by using â€œcat Â»â€ we append Apache output in real-time to the log file. As multiple machines do this simultaneously, you begin to have a single log file from multiple machines. You can do the same thing with your ErrorLog:</p>

<pre><code>ErrorLog  "|/bin/cat Â» /var/www/vhosts/_logs/domain.com-error_log"
</code></pre>

<p>There is a slight problem with this approach: it doesnâ€™t give us enough information. If one of the 4 servers behind the load balancer was the source of a problem, it would be helpful to determine which server each log entry is coming from.</p>

<p>For CustomLog, we can create a new LogType that adds the serverâ€™s IP address at the end of the line, and the LogType name will be â€œcombinedIPâ€:</p>

<pre><code>LogFormat "%h %l %u %t "%r" %&gt;s %b "%{Referer}i" "%{User-Agent}i" %A" combinedIP
</code></pre>

<p>This format is identical to â€œcombinedâ€ and just adds %A at the end. Then, simply change the end of the CustomLog line:</p>

<pre><code>CustomLog "|/bin/cat Â» /var/www/vhosts/_logs/domain.com-access_log" combinedIP
</code></pre>

<p>Hereâ€™s an example of what your log file will look like, showing entries from two servers:</p>

<pre><code>1.2.3.4 - - [07/Dec/2010:11:22:08 -0500] "GET /blog/feed HTTP/1.1" 304 - "-" "-" 192.168.1.6
5.6.7.8 - - [07/Dec/2010:11:22:08 -0500] "GET /blog/feed HTTP/1.1" 304 - "-" "-" 192.168.1.8
</code></pre>

<p>These log entries are the same as the typical â€œcombinedâ€ LogType but with the addition of the IP address at the end.</p>

<p>But what about the ErrorLog? There is no way to define a LogType for the ErrorLog, and it would be helpful to know which server originated error, say, if MaxClients was reached, or there is a misconfiguration in a configuration file. Since weâ€™re piping the ErrorLog output to /bin/cat, we can instead pipe it to a script that simply adds the server hostname on the end (I chose not to use an IP address because 1) some servers have multiple IP addresses, and 2) I cannot insert the VirtualHostâ€™s IP address automatically. Better to know the server and then determine the IP address is necessary). Weâ€™ll start by creating a simple script at /usr/local/bin/httpd_errors (Iâ€™m not using bash since I was not able to get it to write to the log file in real time, it would only write once Apache was reloaded. I did not spend much time to determine why, and I knew it would work in PHP):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x">#!/usr/bin/php -q</span>
</span><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="nv">$stdin</span> <span class="o">=</span> <span class="nb">fopen</span> <span class="p">(</span><span class="err">â€˜</span><span class="nx">php</span><span class="o">://</span><span class="nx">stdin</span><span class="err">â€™</span><span class="p">,</span> <span class="err">â€˜</span><span class="nx">r</span><span class="err">â€™</span><span class="p">);</span>
</span><span class='line'><span class="nb">ob_implicit_flush</span> <span class="p">(</span><span class="k">true</span><span class="p">);</span> <span class="c1">// Use unbuffered output</span>
</span><span class='line'><span class="k">while</span> <span class="p">(</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span> <span class="p">(</span><span class="nv">$stdin</span><span class="p">))</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">print</span> <span class="nb">chop</span><span class="p">(</span><span class="nv">$line</span><span class="p">)</span><span class="o">.</span><span class="err">â€</span> <span class="o">-</span> <span class="err">â€œ</span><span class="o">.</span><span class="nb">system</span><span class="p">(</span><span class="err">â€˜</span><span class="nx">hostname</span> <span class="o">-</span><span class="nx">f</span><span class="err">â€™</span><span class="p">)</span><span class="o">.</span><span class="err">â€</span><span class="nx">\n</span><span class="err">â€</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>Make the script executable with â€œchmod +x /usr/local/bin/httpd_errorsâ€, and then change your ErrorLog in your Apache configuration:</p>

<pre><code>ErrorLog  â€|/usr/local/bin/httpd_errors Â» /var/www/vhosts/_logs/domain.com-error_logâ€
</code></pre>

<p>And your error logs will now reveal which server the error originated from:</p>

<pre><code>[Tue Dec 07 11:20:51 2010] [error] [client 1.2.3.4] File does not exist: /var/www/vhosts/domain.com/favicon.ico - wsrv1
[Tue Dec 07 11:24:27 2010] [error] [client 5.6.7.8] File does not exist: /var/www/vhosts/domain.com/favicon.ico - wsrv2
</code></pre>

<p>There you have it, combined Apache logs for multiple web servers. If you have any suggestions, questions, tips, etc, leave a comment!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/10/15/native-local-development-environment-os-x/">Native Local Development Environment in OS X</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-15T14:46:00-04:00" pubdate data-updated="true">Oct 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/native-local-development-environment-os-x">Echo &amp; Co. blog</a></em>.</p>

<p><strong>UPDATE:</strong> <a href="/blog/2011/08/24/os-x-107-lion-development-native-mamp-mysql-installer/">A newer version of this has been posted here</a>.</p>

<p>Apple OS X comes with Apache and PHP built-in but need some tweaking to work. It also does not come with MySQL. Because of this, many developers have chosen to use MacPorts, Homebrew, or MAMP to install new binaries for Apache, PHP, and MySQL. However, doing this means your system would have multiple copies of Apache and PHP on your machine, and could create conflicts depending on how your built-in tools are configured. This tutorial will show you how to get the built-in versions of Apache and PHP running with an easy to install version of MySQL.</p>

<p>Additionally, it will show how to set up and install Drush, and phpMyAdmin. Setting up a new website is as easy as editing a single text file and adding a line to your <em>/etc/hosts</em> file. All of our changes will avoid editing default configuration files, either those provided by Apple in OS X or from downloaded packages, so that future updates will not break our customizations.</p>

<h2>Apache</h2>

<ul>
<li>Apple uses what appears to be the FreeBSD &ldquo;version&rdquo; of Apache 2.2, and includes various sample files. One of the sample files is a virtual hosts file that we will copy to our <em>~/Sites</em> folder for easy editing. Launch the terminal and get started:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>cp /etc/apache2/extra/httpd-vhosts.conf ~/Sites
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>In order to prevent future major OS updates from breaking our configuration, we&rsquo;ll be editing as few existing files as possible. Luckily, by default, OS X&rsquo;s <em>httpd.conf</em> file (the main configuration file for Apache) includes all <em>.conf files in another folder, </em>/etc/apache2/other*:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>tail -1 /etc/apache2/httpd.conf
</span><span class='line'>Include /private/etc/apache2/other/*.conf
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>We then create a symbolic link in <em>/etc/apache2/other</em> to our newly-copied <em>httpd-vhosts.conf</em> from our <em>~/Sites</em> folder:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo ln -s ~/Sites/httpd-vhosts.conf /etc/apache2/other
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>The <em>~/Sites/httpd-vhosts.conf</em> is now where we will add all new virtual hosts. We will place our site root folders in <em>~/Sites</em> and define them in this file. But first, we need to make some changes (or, <a href="http://www.echoditto.com/sites/default/files/labs/httpd-vhosts.conf_.txt">download this edited httpd-vhosts.conf file</a> and change <strong>fname</strong> in <strong>/Users/fname</strong> to the appropriate path for your system). Begin by adding this text to the top of the file, which will enable the <em>~/Sites</em> folder and subfolders to be accessed by Apache (again, replace <em>/Users/fname</em> with your appropriate path for home directory):</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Ensure all of the VirtualHost directories are listed below</span>
</span><span class='line'>&lt;Directory <span class="s2">&quot;/Users/fname/Sites&quot;</span>&gt;
</span><span class='line'>    Options Indexes FollowSymLinks MultiViews
</span><span class='line'>    AllowOverride All
</span><span class='line'>    Order allow,deny
</span><span class='line'>    Allow from all
</span><span class='line'>&lt;/Directory&gt;
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Add these lines anywhere in the file to ensure that <a href="http://localhost">http://localhost</a> still serves the default folder:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># For localhost in the OS X default location</span>
</span><span class='line'>&lt;VirtualHost _default_:80&gt;
</span><span class='line'>  ServerName localhost
</span><span class='line'>  DocumentRoot /Library/WebServer/Documents
</span><span class='line'>&lt;/VirtualHost&gt;&lt;/code&gt;
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>We will cover setting up a Virtual Host later, so let&rsquo;s reload our Apache settings to activate our new configuration:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apachectl graceful
</span></code></pre></td></tr></table></div></figure>


<p>Or, go to the <strong>Sharing Preference Pane</strong> and uncheck/[re]check the <strong>Web Sharing</strong> item to stop and start Apache.</p>

<p><img src="http://www.echoditto.com/sites/default/files/1Sharing-1.jpg" alt="Sharing" /></p>

<h2>PHP</h2>

<ul>
<li>As of OS X 10.6.6, OS X ships with PHP 5.3.3, but it is not enabled in Apache by default. By looking at <em>/etc/apache2/httpd.conf</em>, you can see that the line to load in the PHP module is commented out:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>grep php /etc/apache2/httpd.conf
</span><span class='line'><span class="c">#LoadModule php5_module        libexec/apache2/libphp5.so&lt;/code&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Since we are trying to avoid editing default configuration files where possible, we can add this information, along with the configuration to allow <em>.php files to run, without the comment at the beginning of the line, in the same folder that we put the symlink for </em>httpd-vhosts.conf*:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo sh -c <span class="s2">&quot;cat &gt; /etc/apache2/other/php5-loadmodule.conf &lt;&lt;&#39;EOF&#39;</span>
</span><span class='line'><span class="s2">LoadModule php5_module        libexec/apache2/libphp5.so</span>
</span><span class='line'><span class="s2">EOF&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>PHP on OS X does not come with a configuration file at php.ini and PHP runs on its defaults. There is, however, a sample file ready to be copied and edited. The lines below will copy the sample file to <em>/etc/php.ini</em> (optionally, <a href="http://www.echoditto.com/sites/default/files/labs/php.ini_.txt">download the edited file</a> and insert at <em>/etc/php.ini</em>) and add some developer-friendly changes to your configuration.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo cp -a /etc/php.ini.default /etc/php.ini
</span><span class='line'><span class="nv">$ </span>sudo sh -c <span class="s2">&quot;cat &gt;&gt; /etc/php.ini &lt;&lt;&#39;EOF&#39;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="s2">;;</span>
</span><span class='line'><span class="s2">;; User customizations below</span>
</span><span class='line'><span class="s2">;;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">; Original - memory_limit = 128M</span>
</span><span class='line'><span class="s2">memory_limit = 196M</span>
</span><span class='line'><span class="s2">; Original - post_max_size = 8M</span>
</span><span class='line'><span class="s2">post_max_size = 200M</span>
</span><span class='line'><span class="s2">; Original - upload_max_filesize = 2M</span>
</span><span class='line'><span class="s2">upload_max_filesize = 100M</span>
</span><span class='line'><span class="s2">; Original - default_socket_timeout = 60</span>
</span><span class='line'><span class="s2">default_socket_timeout = 600</span>
</span><span class='line'><span class="s2">; Original - max_execution_time = 30</span>
</span><span class='line'><span class="s2">max_execution_time = 300</span>
</span><span class='line'><span class="s2">; Original - max_input_time = 60</span>
</span><span class='line'><span class="s2">max_input_time = 600</span>
</span><span class='line'><span class="s2">; Original - log_errors = off</span>
</span><span class='line'><span class="s2">log_errors = on</span>
</span><span class='line'><span class="s2">; Original - display_errors = Off</span>
</span><span class='line'><span class="s2">display_errors = on</span>
</span><span class='line'><span class="s2">; Original - display_startup_errors = Off</span>
</span><span class='line'><span class="s2">display_startup_errors = on</span>
</span><span class='line'><span class="s2">; Original - error_reporting = E_ALL &amp; ~E_DEPRECATED</span>
</span><span class='line'><span class="s2">error_reporting = E_ALL &amp; ~E_DEPRECATED &amp; ~E_NOTICE</span>
</span><span class='line'><span class="s2">EOF&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>OS X&rsquo;s PHP does ship with pear and pecl, but they are not in the $PATH, nor are there binaries to add or symlink to your path. The first two commands will perform a channel-update for pear and again for pecl, the second two will add an alias for each for your current session, and the last two will add the aliases permanently to your local environment (you may get PHP Notices that appear to be errors but they are simply notices. You can change error_reporting in <em>php.ini</em> to silence the Notices):</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo php /usr/lib/php/pearcmd.php channel-update pear.php.net
</span><span class='line'><span class="nv">$ </span>sudo php /usr/lib/php/peclcmd.php channel-update pecl.php.net
</span><span class='line'><span class="nv">$ </span><span class="nb">alias </span><span class="nv">pear</span><span class="o">=</span><span class="s2">&quot;php /usr/lib/php/pearcmd.php&quot;</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">alias </span><span class="nv">pecl</span><span class="o">=</span><span class="s2">&quot;php /usr/lib/php/peclcmd.php&quot;</span>
</span><span class='line'><span class="nv">$ </span>cat &gt;&gt; ~/.bashrc <span class="s">&lt;&lt;&#39;EOF&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="s">alias pear=&quot;php /usr/lib/php/pearcmd.php&quot;</span>
</span><span class='line'><span class="s">alias pecl=&quot;php /usr/lib/php/peclcmd.php&quot;</span>
</span><span class='line'><span class="s">EOF</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>We do a lot of Drupal development, and a commonly-added PHP PECL module for Drupal is uploadprogress. With the new alias we just set, adding it is easy. Build the PELC package, add it <em>php.ini</em>, and reload the PHP configuration into Apache:
<sub>Note: PECL modules require a compiler such as gcc to build. Install Xcode to build PECL packages such as uploadprogress.</sub></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>pecl install uploadprogress
</span><span class='line'><span class="nv">$ </span>sudo sh -c <span class="s2">&quot;cat &gt;&gt; /etc/php.ini &lt;&lt;&#39;EOF&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">; Enable PECL extension uploadprogress</span>
</span><span class='line'><span class="s2">extension=uploadprogress.so</span>
</span><span class='line'><span class="s2">EOF&quot;</span>
</span><span class='line'><span class="nv">$ </span>sudo apachectl graceful
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>If you&rsquo;d like to install APC, see <a href="http://pecl.php.net/bugs/bug.php?id=15968">http://pecl.php.net/bugs/bug.php?id=15968</a> and search for **[2009-09-10 23:16 UTC]**, or if you are using <a href="http://mxcl.github.com/homebrew/">Homebrew</a>, see <a href="http://i.justrealized.com/2010/install-php-apc-mac-os/">http://i.justrealized.com/2010/install-php-apc-mac-os/</a></a>.</li>
</ul>


<h2>MySQL</h2>

<p>MySQL is the only thing that doesn&rsquo;t not ship with OS X that is needed to run a &ldquo;LAMP&rdquo; website like Drupal or WordPress. MySQL/Sun/Oracle provides pre-built MySQL binaries for OS X that don&rsquo;t conflict with other system packages, and even provides a nice System Preferences pane for starting/stopping the process and a checkbox to start MySQL at boot.</p>

<ul>
<li>Go to the download site for OS X pre-built binaries at: <a href="http://dev.mysql.com/downloads/mysql/index.html#macosx-dmg">http://dev.mysql.com/downloads/mysql/index.html#macosx-dmg</a> and choose the most appropriate type for your system. For systems running Snow Leopard, choose <strong>Mac OS X ver. 10.6 (x86, 64-bit), DMG Archive</strong> (on the following screen, you can scroll down for the download links to avoid having to create a user and password).</li>
</ul>


<p><img src="http://www.echoditto.com/sites/default/files/labs/2MySQL%20__%20Download%20MySQL%20Community%20Server.jpg" alt="Download DMG" /></p>

<ul>
<li>Open the downloaded disk image and begin by installing the <strong>mysql-5.1.51-osx10.6-x86_64.pkg</strong> file (or named similarly to the version number you downloaded):</li>
</ul>


<p><img src="http://www.echoditto.com/sites/default/files/labs/3Install%20MySQL%205.1.51-community%20for%20Mac%20OS%20X.jpg" alt="MySQL Installer" /></p>

<p>Once the Installer script is completed, install the Preference Pane by double-clicking on <strong>MySQL.prefPane</strong>. If you are not sure where to install the preference pane, choose &ldquo;Install for this user only&rdquo;:</p>

<p><sub><strong>Note:</strong> If you wish to have MySQL start on boot, check out the <a href="http://stackoverflow.com/questions/1334272/cant-start-mysql-in-mac-os-10-6-snow-leopard">first answer on this Stack Overflow post</a>.</sub></p>

<p><img src="http://www.echoditto.com/sites/default/files/labs/4System%20Preferences.jpg" alt="Install MySQL System Preferences pane" /></p>

<ul>
<li>The preference pane is now installed and you can check the box to have MySQL start on boot or start and stop it on demand with this button. To access this screen again, load System Preferences. Click &ldquo;Start MySQL Server&rdquo; now:</li>
</ul>


<p><img src="http://www.echoditto.com/sites/default/files/5MySQL.jpg" alt="MySQL pane" /></p>

<ul>
<li>The MySQL installer installed its files to /usr/local/mysql, and the binaries are in /usr/local/mysql/bin which is not in the $PATH of any user by default. Rather than edit the $PATH shell variable, we add symbolic links in /usr/local/bin (a location already in $PATH) to a few MySQL binaries. Add more or omit as desired. This is an optional step, but will make tasks like using Drush or performing a mysqldump in the command line much easier:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /usr/local/bin
</span><span class='line'>ln -s /usr/local/mysql/bin/mysql
</span><span class='line'>ln -s /usr/local/mysql/bin/mysqladmin
</span><span class='line'>ln -s /usr/local/mysql/bin/mysqldump
</span><span class='line'>ln -s /usr/local/mysql/support-files/mysql.server
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Next we&rsquo;ll run <code>mysql_secure_installation</code> to set the root user&rsquo;s password and other setup-related tasks. This script ships with MySQL and only needs to be run once, and it should be run with sudo. As you run it, you can accept all other defaults after you set the root user&rsquo;s password:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo /usr/local/mysql/bin/mysql_secure_installation
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>If you were create a simple php file containing &ldquo;phpinfo();&rdquo; to view the PHP Information, you will see that Apple-built PHP looks for the MySQL socket at <em>/var/mysql/mysql.sock</em>:</li>
</ul>


<p><img src="http://www.echoditto.com/sites/default/files/labs/6phpinfo.jpg" alt="phpinfo" /></p>

<p>The problem is that the MySQL binary provided by Oracle puts the socket file in <em>/tmp</em>, which is the standard location on most systems. Other tutorials have recommended rebuilding PHP from source, or changing where PHP looks for the socket file via <em>/etc/php.ini</em>, or changing where MySQL places it when starting via <em>/etc/my.cnf</em>, but it is far easier and more fool-proof to create a symbolic link for <em>/tmp/mysql.sock</em> in the location OS X&rsquo;s PHP is looking for it. Since this keeps us from changing defaults, it ensures that a PHP update (via Apple) or a MySQL update (via Oracle) will not have an impact on functionality:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo mkdir /var/mysql
</span><span class='line'>sudo chown _mysql:wheel /var/mysql
</span><span class='line'>sudo ln -s /tmp/mysql.sock /var/mysql
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>After installing MySQL, several sample my.cnf files are created but none is placed in <em>/etc/my.cnf</em>, meaning that MySQL will always load in the default configuration. Since we will be using MySQL for local development, we will start with a &ldquo;small&rdquo; configuration file and make a few changes to increase the max_allowed_packet variable under <strong>[mysqld]</strong> and <strong>[mysqldump]</strong> (optionally, use the contents of <a href="http://www.echoditto.com/sites/default/files/labs/my.cnf_.txt">this sample file</a> in <em>/etc/my.cnf</em>). Later on, we can edit <em>/etc/my.cnf</em> to make other changes as desired:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo cp /usr/local/mysql/support-files/my-small.cnf /etc/my.cnf
</span><span class='line'>sudo sed -i <span class="s2">&quot;&quot;</span> <span class="s1">&#39;s/max_allowed_packet = 16M/max_allowed_packet = 2G/g&#39;</span> /etc/my.cnf
</span><span class='line'>sudo sed -i <span class="s2">&quot;&quot;</span> <span class="s2">&quot;/\[mysqld\]/ a\\`echo -e &#39;\n\r&#39;`max_allowed_packet = 2G`echo -e &#39;\n\r&#39;`&quot;</span> /etc/my.cnf
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>To load in these changes, go back to the MySQL System Preferences pane, and restart the server by pressing &ldquo;Stop MySQL Server&rdquo; followed by &ldquo;Start MySQL Server.&rdquo; Or, you can do this on the command line (if you added this symlink as shown above):</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo mysql.server restart
</span><span class='line'>
</span><span class='line'>Shutting down MySQL
</span><span class='line'>... SUCCESS!
</span><span class='line'>Starting MySQL
</span><span class='line'>... SUCCESS!
</span></code></pre></td></tr></table></div></figure>


<h2>phpMyAdmin</h2>

<p>At this point, the full &ldquo;MAMP stack&rdquo; (Macintosh OS X, Apache, MySQL, PHP) is ready, but adding phpMyAdmin will make administering your MySQL install easier.</p>

<ul>
<li><p>phpMyAdmin will complain that the PHP extension &lsquo;php-mcrypt&rsquo; is not available. Since you will not likely be allowing anyone other than yourself to use phpMyAdmin, you could ignore it, but if you want to build the extension, it is possible to build it as a shared object instead of having to rebuild PHP from source. Follow Michael Gracie&rsquo;s guide here (for his Step 2, grab the PHP source that matches <code>$ php --version</code> on your system): <a href="http://michaelgracie.com/2009/09/23/plugging-mcrypt-into-php-on-mac-os-x-snow-leopard-10.6.1/">http://michaelgracie.com/2009/09/23/plugging-mcrypt-into-php-on-mac-os-x-snow-leopard-10.6.1/</a> (or, if you prefer Homebrew: <a href="http://blog.rogeriopvl.com/archives/php-mcrypt-in-snow-leopard-with-homebrew/">http://blog.rogeriopvl.com/archives/php-mcrypt-in-snow-leopard-with-homebrew/</a>.</p>

<p>The following files will be added:</p>

<ul>
<li> /usr/local/lib/libmcrypt</li>
<li> /usr/local/include/mcrypt.h</li>
<li> /usr/local/include/mutils/mcrypt.h</li>
<li> /usr/local/bin/libmcrypt-config</li>
<li> /usr/local/lib/libmcrypt.la</li>
<li> /usr/local/lib/libmcrypt.4.4.8.dylib</li>
<li> /usr/local/lib/libmcrypt.4.dylib</li>
<li> /usr/local/lib/libmcrypt.dylib</li>
<li> /usr/local/share/aclocal/libmcrypt.m4</li>
<li> /usr/local/man/man3/mcrypt.3</li>
<li> /usr/lib/php/extensions/no-debug-non-zts-20090626/mcrypt.so</li>
</ul>
</li>
<li><p>The following lines will install the latest phpMyAdmin to <em>/Library/WebServer/Documents</em> and set up <em>config.inc.php</em>. Afterwards, you will be able to access phpMyAdmin at <a href="http://localhost/phpMyAdmin"><a href="http://localhost/phpMyAdmin">http://localhost/phpMyAdmin</a></a>:</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /Library/WebServer/Documents
</span><span class='line'>curl -s -L -O http://downloads.sourceforge.net/project/phpmyadmin/phpMyAdmin/<span class="sb">`</span>curl -s -L http://www.phpmyadmin.net/home_page/index.php | grep -m1 dlname |awk -F<span class="s1">&#39;Download &#39;</span> <span class="s1">&#39;{print $2}&#39;</span>|cut -d <span class="s2">&quot;&lt;&quot;</span> -f1<span class="sb">`</span>/phpMyAdmin-<span class="sb">`</span>curl -s -L http://www.phpmyadmin.net/home_page/index.php | grep -m1 dlname |awk -F<span class="s1">&#39;Download &#39;</span> <span class="s1">&#39;{print $2}&#39;</span>|cut -d <span class="s2">&quot;&lt;&quot;</span> -f1<span class="sb">`</span>-english.tar.gz
</span><span class='line'>tar zxpf <span class="sb">`</span>ls -1 phpMyAdmin*tar.gz|sort|tail -1<span class="sb">`</span>
</span><span class='line'>rm <span class="sb">`</span>ls -1 phpMyAdmin*tar.gz|sort|tail -1<span class="sb">`</span>
</span><span class='line'>mv <span class="sb">`</span>ls -d1 phpMyAdmin-*|sort|tail -1<span class="sb">`</span> phpMyAdmin
</span><span class='line'><span class="nb">cd </span>phpMyAdmin
</span><span class='line'>cp config.sample.inc.php config.inc.php
</span><span class='line'>sed -i <span class="s2">&quot;&quot;</span> <span class="s2">&quot;s/blowfish_secret\&#39;\] = \&#39;/blowfish_secret\&#39;\] = \&#39;`cat /dev/urandom | strings | grep -o &#39;[[:alnum:]]&#39; | head -n 50 | tr -d &#39;\n&#39;`/&quot;</span> config.inc.php
</span></code></pre></td></tr></table></div></figure>


<h2>Drush</h2>

<p>Drush is a helpful tool that provides a &ldquo;Drupal shell&rdquo; to speed up your Drupal development.</p>

<ul>
<li>Run the following in the Terminal to get Drush 4.2 installed in <em>/usr/local</em> and add drush to the $PATH:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>svn co http://subversible.svn.beanstalkapp.com/modules/drush/tags/DRUPAL-7--4-2/ /usr/local/drush
</span><span class='line'><span class="nb">cd</span> /tmp
</span><span class='line'>pear download Console_Table
</span><span class='line'>tar zxvf <span class="sb">`</span>ls Console_Table-*.tgz<span class="sb">`</span> <span class="sb">`</span>ls Console_Table-*.tgz | sed -e <span class="s1">&#39;s/\.[a-z]\{3\}$//&#39;</span><span class="sb">`</span>/Table.php
</span><span class='line'>mv <span class="sb">`</span>ls Console_Table-*.tgz | sed -e <span class="s1">&#39;s/\.[a-z]\{3\}$//&#39;</span><span class="sb">`</span>/Table.php /usr/local/drush/includes/table.inc
</span><span class='line'>rm -fr Console_Table-*
</span><span class='line'>ln -s /usr/local/drush/drush /usr/local/bin/drush&lt;/code&gt;
</span></code></pre></td></tr></table></div></figure>


<h2>Virtual Hosts</h2>

<p>Now that all of the components to run a website locally are in place, it only takes a few changes to <em>~/Sites/httpd-vhosts.conf</em> to get a new local site up and running.</p>

<ul>
<li><p>Your website code should be in a directory in <em>~/Sites</em>. For the purposes of this example, the webroot will be at <em>~/Sites/thewebsite</em>.</p></li>
<li><p>You need to choose a &ldquo;domain name&rdquo; for your local site that you will use to access it in your browser. For the example, we will use &ldquo;myproject.local&rdquo;. The first thing you need to do is add a line to <em>/etc/hosts</em> to direct your &ldquo;domain name&rdquo; to your local system:</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo sh -c <span class="err">&quot;</span>cat &gt;&gt; /etc/hosts <span class="s">&lt;&lt;&#39;EOF&#39;</span>
</span><span class='line'><span class="s">127.0.0.1 myproject.local</span>
</span><span class='line'><span class="s">EOF</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>If you have been following the rest of this guide and used a copy of <em>/etc/apache2/extra/httpd-vhosts.conf</em> in <em>~/Sites/httpd-vhosts.conf</em>, you can delete the first of the two example Virtual Hosts and edit the second one. You can also delete the <strong>ServerAdmin</strong> line as it is not necessary.</p></li>
<li><p>Change the <strong>ServerName</strong> to <strong>myproject.local</strong> (or whatever you entered into <em>/etc/hosts</em>) so Apache will respond when you visit <a href="http://myproject.local">http://myproject.local</a> in a browser.</p></li>
<li><p>Change the <strong>DocumentRoot</strong> to the path of your webroot, which in this example is <strong>/Users/fname/Sites/thewebsite</strong></p></li>
<li><p>It&rsquo;s highly recommended to set a CustomLog and an ErrorLog for each virtual host, otherwise all logged output will be in the same file for all sites. Change the line starting with <strong>CustomLog</strong> from &ldquo;dummy-host2.example.com-access_log&rdquo; to &ldquo;myproject.local-access_log&rdquo;, and for <strong>ErrorLog</strong> change &ldquo;dummy-host2.example.com-error_log&rdquo; to &ldquo;myproject.local-error_log&rdquo;</p></li>
<li><p>Save the file and reload the Apache configuration as shown in Step 6 under the Apache section, and visit <a href="http://myproject.local">http://myproject.local</a> in your browser.</p></li>
</ul>


<p>Going forward, all you have to do to add a new website is duplicate and edit the <strong>&lt;VirtualHost *:80></strong> to <strong>&lt;/VirtualHost></strong> section underneath your existing configuration, make new edits, edit <em>/etc/hosts</em> again, and reload Apache.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/08/12/dropbox-cli-centos-5-easy-way/">Dropbox CLI for CentOS 5 the Easy Way</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-12T12:27:00-04:00" pubdate data-updated="true">Aug 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/dropbox-cli-centos-5-easy-way">Echo &amp; Co. blog</a></em>.</p>

<p><a href="http://www.dropbox.com/">Dropbox</a> hardly needs any introduction; put files in your Dropbox and they show up everywhere else you have Dropbox installed and dropbox.com. A feature about Dropbox that is probably not as widely known is that free accounts come with 30 days of undo history and Pro accounts can get &ldquo;Pack Rat&rdquo; that keeps unlimited history of changes. The history of files, including reverting deleted files, was particularly interesting to me, since I could hook in my latest daily MySQL dumps from <a href="http://sourceforge.net/projects/automysqlbackup/">AutoMySQLBackup</a> to Dropbox and have 30 days of backups for free available from anywhere dropbox.com is accessible.</p>

<p>The problem is that we use <a href="http://centos.org/">CentOS</a> for our servers and the Dropbox Linux builds are geared for distributions like Ubuntu and Debian that have updated versions of required software like Python, libc, and others, that I did not want to upgrade by hand on my systems and risk the integrity of the system packages. But, I got it to work anyway, read on for how I got Dropbox CLI installed on CentOS without replacing any system files.</p>

<ul>
<li><p>Download <a href="http://www.getdropbox.com/download?plat=lnx.x86">http://www.getdropbox.com/download?plat=lnx.x86</a> or <a href="http://www.getdropbox.com/download?plat=lnx.x86_64">http://www.getdropbox.com/download?plat=lnx.x86_64</a> <a href="http://forums.dropbox.com/topic.php?id=8386#post-53456">(ref)</a></p></li>
<li><p>Extract tar.gz file downloaded and leave in ~ of desired user</p></li>
<li><p>Run <code>~/.dropbox-dist/dropboxd</code> to get Dropbox to provide a URL to go to in your browser to link this computer to your Dropbox account</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>./dropboxd
</span><span class='line'>This client is not linked to any account...
</span><span class='line'>Please visit https: //www.dropbox.com/cli_link?host_id<span class="o">=</span>xxxxxxxxxxxxxxxxxxxxxxxxxxxx to link this machine.
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>After visiting the URL in a browser to which you&rsquo;ve logged into dropbox.com, you&rsquo;ll see the following output:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/usr/bin/nautilus
</span><span class='line'>cannot open display:
</span><span class='line'>Run <span class="s1">&#39;nautilus --help&#39;</span> to see a full list of available <span class="nb">command </span>line options.
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>If you cannot quit the app, open another a shell, get the PID by running <code>ps -ef|grep dropbox</code>, and kill PID. The output on your other shell should say:
Terminated</p></li>
<li><p>Download the official Dropbox CLI: <a href="http://www.dropbox.com/download?dl=packages/dropbox.py">http://www.dropbox.com/download?dl=packages/dropbox.py</a> <a href="http://wiki.dropbox.com/TipsAndTricks/TextBasedLinuxInstall">(ref)</a></p></li>
<li><p><code>dropbox.py</code> won&rsquo;t work without Python 2.6, but let&rsquo;s not risk messing up our official RHEL packages. Download ActivePython 2.6 (AS Package) from <a href="https://www.activestate.com/activepython/downloads">https://www.activestate.com/activepython/downloads</a> <a href="http://stackoverflow.com/questions/1465036/install-python-2-6-in-centos">(ref)</a></p></li>
<li><p>As mentioned in the AP documentation <a href="http://docs.activestate.com/activepython/2.6/installnotes.html#aspackage">(ref)</a>, run the installer with <code>./install.sh</code> and install where desired. It defaults to <em>/opt/ActivePython-2.6</em>, which is fine because it does not conflcit with the system default python 2.4 install. For my purposes, I had created a user called <em>dropbox</em> that did not have root privileges, so I installed to <em>/home/dropbox/ActivePython-2.6</em>.</p></li>
<li><p>Edit <em>dropbox.py</em> and change <code>#!/usr/bin/python</code> to the path you just installed AP to. For my installation, it&rsquo;s set to <code>#!/home/dropbox/bin/ActivePython-2.6/bin/python</code></p></li>
<li><p>Run <code>dropbox.py</code> without commands to see your available options.</p></li>
</ul>


<p>Optional: To suppress LAN Sync broadcasts, download <a href="http://wiki.dropbox.com/TipsAndTricks/TextBasedLinuxInstall?action=AttachFile&amp;do=view&amp;target=dropboxp2p.py">dropboxp2p.py</a> <a href="http://wiki.dropbox.com/TipsAndTricks/TextBasedLinuxInstall">(ref)</a>, edit the first line to use the ActivePython binary as you did for dropbox.py, and run <code>./dropboxp2p -d</code> to disable LAN syncing (unless you have other machines in the LAN with Dropbox installed, and your firewalls are set up appropriately).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/07/15/tidy-tmp-dev-servers/">Tidy Up /tmp on Dev Servers</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-15T16:53:00-04:00" pubdate data-updated="true">Jul 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>This post originally featured on the <a href="http://echo.co/blog/tidy-tmp-dev-servers">Echo &amp; Co. blog</a></em>.</p>

<p>Today I was made aware of some strange MySQL errors on our development server that ended up being related to a lack of sufficient disk space. Upon inspection, the /tmp partition had completely filled up. A majority of the files were temporary files created by the <a href="http://drupal.org/project/devel">Drupal module devel</a> with devel_themer enabled. Turns out <a href="http://drupal.org/node/327512">these temporary files are not deleted at the end of a session</a>. There were also CURLCOOKIE files related to cron jobs to hit cron.php on various dev and production sites, and some other temporary files that if left unattended could result in the same errors.</p>

<p>My solution is to have these files deleted every night, but only if they&rsquo;re three days old, which should be adequate time for the developer to need access to these temporary files. I added this to root&rsquo;s cron.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Delete some /tmp files older than 3 days
</span><span class='line'>5 4 * * * find /tmp -type f -name "Apache-Session*" -mtime +3 -exec rm -f {} \;
</span><span class='line'>6 4 * * * find /tmp -type f -name "backup_migrate_*" -mtime +3 -exec rm -f {} \;
</span><span class='line'>7 4 * * * find /tmp -type f -name "devel_themer_*" -mtime +3 -exec rm -f {} \;
</span><span class='line'>8 4 * * * find /tmp -type f -name "CURLCOOKIE_*" -mtime +3 -exec rm -f {} \;</span></code></pre></td></tr></table></div></figure>


<p>Similarly, I have a cron job to remove old Apache logs, which is helpful since an old project will never have it&rsquo;s logs deleted unless they&rsquo;re removed manually.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Delete Apache logs older than 30 days
</span><span class='line'>30 3 * * * find /var/log/httpd -type f -mtime +30 -exec rm -f {} \;</span></code></pre></td></tr></table></div></figure>


<p>Do you have other ideas for managing temporary files that don&rsquo;t clean up after themselves? Let me know in the comments.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/22/os-x-1010-yosemite-local-development-environment-apache-php-and-mysql-homebrew/">OS X 10.10 Yosemite Local Development Environment: Apache, PHP, and MySQL With Homebrew</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/09/os-x-109-local-development-environment-apache-php-and-mysql-homebrew/">OS X 10.9 Local Development Environment: Apache, PHP, and MySQL With Homebrew</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/18/whats-the-deal-with-pressflow-7/">What&#8217;s the Deal With Pressflow 7?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/11/creating-php-packages-software-collection/">Creating PHP Packages as a Software Collection</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/09/speed-up-php-on-nfs-with-turbo-realpath/">Speed Up PHP on NFS With Turbo_realpath</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Coderwall</h1>
  <ul id="cw_badges">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <div>
    <a href="http://coderwall.com/alanthing" target="_blank" class="cw_badge"><img
       alt="Endorse alanthing on Coderwall"
       src="http://api.coderwall.com/alanthing/endorsecount.png" /></a>
  </div>
  

  <script type="text/javascript">
    var coderwall = (function(){
      function render(options, badges){
        var fragment = '',
            t = $(options.target),
            height = 65,
            width = 65,
            index;

        for (index in badges) {
          fragment += '<a class="cw_badge"title="' + badges[index].description + '" target="_blank" href="http://coderwall.com/' + options.user + '">';
          fragment +=   '<img alt="' + badges[index].description + '" height="' + width + '" width="' + height + '" src="' + badges[index].badge + '"/>';
          fragment += '</a>';
        }

        t.html(fragment);
      }
      return {
        showBadges: function(options){
          $.ajax({
              url: 'http://coderwall.com/' + options.user + '.json?callback=?'
            , dataType: 'jsonp'
            , error: function (err) { $(options.target + ' li.loading').addClass('error').text("Error loading feed"); }
            , success: function(res) {
                render(options, res.data.badges);
            }
          });
        }
      };
    })();

    $(document).ready(function(){
      coderwall.showBadges({
        user: 'alanthing',
        target: '#cw_badges'
      });
    });
  </script>
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/alanthing">@alanthing</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'alanthing',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Alan Ivey -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'alanthing';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
